<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><link rel="preconnect" href="https://www.googletagmanager.com/"/><link rel="preconnect" href="https://pagead2.googlesyndication.com/"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="google-site-verification" content="rHTd8BRbOeSqAskkyVusn529XiwZ2eHbv1tnB1IDnjA"/><link rel="apple-touch-icon" sizes="57x57" href="/en/assets/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/en/assets/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/en/assets/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/en/assets/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/en/assets/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/en/assets/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/en/assets/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/en/assets/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/en/assets/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/en/assets/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/en/assets/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/en/assets/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/en/assets/favicon/favicon-16x16.png"/><link rel="manifest" href="/en/assets/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/assets/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="apple-mobile-web-app-title" content="DeKu blog"/><link rel="apple-touch-icon" href="/en/assets/favicon/android-icon-144x144.png"/><meta name="twitter:title" content="In-App Purchases in React Native"/><meta name="twitter:description" content="Let's see how to use react-native-iap to implement IAP(In-App Purchases) in React Native."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@DevYakuza"/><meta name="twitter:creator" content="@DevYakuza"/><title>In-App Purchases in React Native - Let's see how to use react-native-iap to implement IAP(In-App Purchases) in React Native.</title><meta name="description" content="Let&#39;s see how to use react-native-iap to implement IAP(In-App Purchases) in React Native."/><meta http-equiv="Content-Language" content="en"><link rel="alternate" hreflang="ja" href="https://deku.posstree.com/react-native/react-native-iap/"/><link rel="alternate" hreflang="ko" href="https://deku.posstree.com/ko/react-native/react-native-iap/"/><link rel="alternate" hreflang="en" href="https://deku.posstree.com/en/react-native/react-native-iap/"/><meta property="og:url" content="https://deku.posstree.com/en/react-native/react-native-iap/"/><meta name="generator" content="Jekyll v3.9.5"/><meta property="og:title" content="In-App Purchases in React Native"/><meta name="author" content="dev.yakuza@gmail.com"/><meta property="og:locale" content="en"/><meta name="description" content="Let’s see how to use react-native-iap to implement IAP(In-App Purchases) in React Native."/><meta property="og:description" content="Let’s see how to use react-native-iap to implement IAP(In-App Purchases) in React Native."/><link rel="canonical" href="https://deku.posstree.com/en/react-native/react-native-iap/"/><meta property="og:url" content="https://deku.posstree.com/react-native/react-native-iap/"/><meta property="og:site_name" content="Deku"/><meta property="og:image" content="https://deku.posstree.com/assets/images/category/react-native/2020/react-native-iap/background.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2020-10-23T00:00:00+09:00"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://deku.posstree.com/assets/images/category/react-native/2020/react-native-iap/background.jpg"/><meta property="twitter:title" content="In-App Purchases in React Native"/><script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"dev.yakuza@gmail.com"},"dateModified":"2023-10-17T10:00:58+09:00","datePublished":"2020-10-23T00:00:00+09:00","description":"Let’s see how to use react-native-iap to implement IAP(In-App Purchases) in React Native.","headline":"In-App Purchases in React Native","image":"https://deku.posstree.com/assets/images/category/react-native/2020/react-native-iap/background.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://deku.posstree.com/react-native/react-native-iap/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://deku.posstree.com/assets/images/icon.jpg"},"name":"dev.yakuza@gmail.com"},"url":"https://deku.posstree.com/react-native/react-native-iap/"}</script><link href="https://www.googletagmanager.com/gtag/js?id=UA-125408913-1" rel="preload" as="script"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125408913-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-125408913-1");</script><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Noto+Sans"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans"/><link rel="preload" as="style" href="/en/assets/vendor/bootstrap/css/bootstrap.min.css"/><link rel="stylesheet" href="/en/assets/vendor/bootstrap/css/bootstrap.min.css"/><link rel="preload" as="style" href="/en/assets/vendor/font-awesome/css/font-awesome.min.css"/><link rel="stylesheet" href="/en/assets/vendor/font-awesome/css/font-awesome.min.css"/><link rel="preload" as="style" href="/en/assets/main.css?v=20241127"/><link rel="stylesheet" href="/en/assets/main.css?v=20241127"/><link rel="alternate" type="application/rss+xml" title="Deku" href="/en/feed.xml"/><script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "dev.yakuza",
      "url": "https://deku.posstree.com/",
      "sameAs": [
        "https://www.facebook.com/yakuza.dev.54",
        "https://www.instagram.com/dev_yakuza/",
        "https://twitter.com/DevYakuza"
      ]
    }
  </script><script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://deku.posstree.com/",
      "logo": "https://deku.posstree.com/assets/images/icon.jpg"
    }
  </script><script type="application/ld+json">
    {
      "@context":"http://schema.org",
      "@type":"ItemList",
      "itemListElement":[{
          "@type":"ListItem",
          "name": "How to install React Native on Mac",
          "description" : "Let's see how to install and configure react-native development environment on Mac, and create react native project to check the environment is set well.",
          "position":1,"url": "https://deku.posstree.com/en/react-native/install-on-mac/",
          "item": "https://deku.posstree.com/en/react-native/install-on-mac/"},{
          "@type":"ListItem",
          "name": "How to install React Native on Windows",
          "description" : "Let's see how to install and configure react-native development environment on Windows, and create react native project to check the environment is set well.",
          "position":2,"url": "https://deku.posstree.com/en/react-native/install-on-windows/",
          "item": "https://deku.posstree.com/en/react-native/install-on-windows/"},{
          "@type":"ListItem",
          "name": "RN installation",
          "description" : "install react-native and check how to make a project.",
          "position":3,"url": "https://deku.posstree.com/en/react-native/installation/",
          "item": "https://deku.posstree.com/en/react-native/installation/"},{
          "@type":"ListItem",
          "name": "How to use TypeScript in React Native",
          "description" : "Let's see how to configure TypeScript and how to use TypeScript in React Native.",
          "position":4,"url": "https://deku.posstree.com/en/react-native/typescript/",
          "item": "https://deku.posstree.com/en/react-native/typescript/"},{
          "@type":"ListItem",
          "name": "Use ESLint, Prettier like Pro on React Native",
          "description" : "Let's see how to use ESLint and Prettier on React Native project, and Let's see how to use Husky and lint-staged to use ESLint and Prettier like Pro.",
          "position":5,"url": "https://deku.posstree.com/en/react-native/eslint-prettier-husky-lint-staged/",
          "item": "https://deku.posstree.com/en/react-native/eslint-prettier-husky-lint-staged/"},{
          "@type":"ListItem",
          "name": "styled-components",
          "description" : "this blog is about how to use styled-component library for react-native styling.",
          "position":6,"url": "https://deku.posstree.com/en/react-native/styled-components/",
          "item": "https://deku.posstree.com/en/react-native/styled-components/"},{
          "@type":"ListItem",
          "name": "react-navigation",
          "description" : "use react-navigation for developing an application.",
          "position":7,"url": "https://deku.posstree.com/en/react-native/react-navigation/",
          "item": "https://deku.posstree.com/en/react-native/react-navigation/"},{
          "@type":"ListItem",
          "name": "react-navigation V5",
          "description" : "Let's see how to install react-navigaion V5 and how to use it.",
          "position":8,"url": "https://deku.posstree.com/en/react-native/react-navigation-v5/",
          "item": "https://deku.posstree.com/en/react-native/react-navigation-v5/"},{
          "@type":"ListItem",
          "name": "App icon",
          "description" : "try to make app icon by using generator-rn-toolbox",
          "position":9,"url": "https://deku.posstree.com/en/react-native/app-icon/",
          "item": "https://deku.posstree.com/en/react-native/app-icon/"},{
          "@type":"ListItem",
          "name": "Splash image",
          "description" : "generate and apply splash image by using generator-rn-toolbox",
          "position":10,"url": "https://deku.posstree.com/en/react-native/splash-image/",
          "item": "https://deku.posstree.com/en/react-native/splash-image/"},{
          "@type":"ListItem",
          "name": "NativeBase",
          "description" : "use NativeBase library for basic component UI.",
          "position":11,"url": "https://deku.posstree.com/en/react-native/nativebase/",
          "item": "https://deku.posstree.com/en/react-native/nativebase/"},{
          "@type":"ListItem",
          "name": "react-native-vector-icons",
          "description" : "let's display icons to use react-native-vector-icons library.",
          "position":12,"url": "https://deku.posstree.com/en/react-native/react-native-vector-icons/",
          "item": "https://deku.posstree.com/en/react-native/react-native-vector-icons/"},{
          "@type":"ListItem",
          "name": "react-native-device-info",
          "description" : "use react-native-device-info for getting user's device informations.",
          "position":13,"url": "https://deku.posstree.com/en/react-native/react-native-device-info/",
          "item": "https://deku.posstree.com/en/react-native/react-native-device-info/"},{
          "@type":"ListItem",
          "name": "react-native-tts",
          "description" : "implement text-to-speech to use react-native-tts",
          "position":14,"url": "https://deku.posstree.com/en/react-native/react-native-tts/",
          "item": "https://deku.posstree.com/en/react-native/react-native-tts/"},{
          "@type":"ListItem",
          "name": "Google Admob",
          "description" : "use react-native-admob to add google admob advertisement to react-native.",
          "position":15,"url": "https://deku.posstree.com/en/react-native/react-native-admob/",
          "item": "https://deku.posstree.com/en/react-native/react-native-admob/"},{
          "@type":"ListItem",
          "name": "iOS device test",
          "description" : "let's test RN(react native) project on iOS devices",
          "position":16,"url": "https://deku.posstree.com/en/react-native/ios-test-on-device/",
          "item": "https://deku.posstree.com/en/react-native/ios-test-on-device/"},{
          "@type":"ListItem",
          "name": "iOS build and test",
          "description" : "let's build RN(react native) for iOS production and test it on the device.",
          "position":17,"url": "https://deku.posstree.com/en/react-native/ios-running-on-device/",
          "item": "https://deku.posstree.com/en/react-native/ios-running-on-device/"},{
          "@type":"ListItem",
          "name": "enroll iOS developer",
          "description" : "let's see how to enroll Apple Developer Program for registering RN(react native) app to iOS App store.",
          "position":18,"url": "https://deku.posstree.com/en/react-native/ios-enroll-developer-program/",
          "item": "https://deku.posstree.com/en/react-native/ios-enroll-developer-program/"},{
          "@type":"ListItem",
          "name": "iOS Certification",
          "description" : "if you enrolled Apple Developer Program, let's see how to configure iOS developer Certification.",
          "position":19,"url": "https://deku.posstree.com/en/react-native/ios-certification/",
          "item": "https://deku.posstree.com/en/react-native/ios-certification/"},{
          "@type":"ListItem",
          "name": "iOS TestFlight",
          "description" : "let's test the app by tester via TestFlight..",
          "position":20,"url": "https://deku.posstree.com/en/react-native/ios-testflight/",
          "item": "https://deku.posstree.com/en/react-native/ios-testflight/"},{
          "@type":"ListItem",
          "name": "register iOS App store",
          "description" : "let's see what we need to register iOS App Store.",
          "position":21,"url": "https://deku.posstree.com/en/react-native/ios-app-store/",
          "item": "https://deku.posstree.com/en/react-native/ios-app-store/"},{
          "@type":"ListItem",
          "name": "Google Analytics",
          "description" : "let's analyze RN(react native) app using Google Analytics.",
          "position":22,"url": "https://deku.posstree.com/en/react-native/react-native-analytics-bridge/",
          "item": "https://deku.posstree.com/en/react-native/react-native-analytics-bridge/"},{
          "@type":"ListItem",
          "name": "Firebase Admob",
          "description" : "let's use react-native-firebase library to display Google Admob.",
          "position":23,"url": "https://deku.posstree.com/en/react-native/react-native-firebase-admob/",
          "item": "https://deku.posstree.com/en/react-native/react-native-firebase-admob/"},{
          "@type":"ListItem",
          "name": "Android device test",
          "description" : "let's test RN(react native) project on Android devices",
          "position":24,"url": "https://deku.posstree.com/en/react-native/android-test-on-device/",
          "item": "https://deku.posstree.com/en/react-native/android-test-on-device/"},{
          "@type":"ListItem",
          "name": "Android build and test",
          "description" : "introduce how to build and test RN(react native) project on Android device.",
          "position":25,"url": "https://deku.posstree.com/en/react-native/android-running-on-device/",
          "item": "https://deku.posstree.com/en/react-native/android-running-on-device/"},{
          "@type":"ListItem",
          "name": "change simulator on iOS",
          "description" : "let's see how to change the simulator on iOS when we test RN(react native) on iOS.",
          "position":26,"url": "https://deku.posstree.com/en/react-native/ios-change-simulator/",
          "item": "https://deku.posstree.com/en/react-native/ios-change-simulator/"},{
          "@type":"ListItem",
          "name": "Firebase Analytics",
          "description" : "let's analyze the app more detail using react-native-firebase.",
          "position":27,"url": "https://deku.posstree.com/en/react-native/react-native-firebase-analytics/",
          "item": "https://deku.posstree.com/en/react-native/react-native-firebase-analytics/"},{
          "@type":"ListItem",
          "name": "iOS App crash analysis",
          "description" : "let's see how to analyze iOS App crash log.",
          "position":28,"url": "https://deku.posstree.com/en/react-native/ios-app-crash-debugging/",
          "item": "https://deku.posstree.com/en/react-native/ios-app-crash-debugging/"},{
          "@type":"ListItem",
          "name": "Firebase Crashlytics",
          "description" : "let's see how to use react-native-firebase to gather crash logs on Filebase Crashlytics.",
          "position":29,"url": "https://deku.posstree.com/en/react-native/firebase-crashlytics/",
          "item": "https://deku.posstree.com/en/react-native/firebase-crashlytics/"},{
          "@type":"ListItem",
          "name": "react-native-animatable",
          "description" : "let's see how to use react-native-animatable to add simply animations to RN(react native).",
          "position":30,"url": "https://deku.posstree.com/en/react-native/react-native-animatable/",
          "item": "https://deku.posstree.com/en/react-native/react-native-animatable/"},{
          "@type":"ListItem",
          "name": "enroll Android developer",
          "description" : "let's enroll Android developer to register Android App to Google Playstore.",
          "position":31,"url": "https://deku.posstree.com/en/react-native/android-enroll-google-play-developer/",
          "item": "https://deku.posstree.com/en/react-native/android-enroll-google-play-developer/"},{
          "@type":"ListItem",
          "name": "register Android App store",
          "description" : "we'll introduce how to register RN(React Native) Android App to Android App store(Google Play).",
          "position":32,"url": "https://deku.posstree.com/en/react-native/android-google-play/",
          "item": "https://deku.posstree.com/en/react-native/android-google-play/"},{
          "@type":"ListItem",
          "name": "recognize user voice",
          "description" : "let's see how to add the feature to recognize user voice and transform to text by react-native-voice on RN(React Native)",
          "position":33,"url": "https://deku.posstree.com/en/react-native/react-native-voice/",
          "item": "https://deku.posstree.com/en/react-native/react-native-voice/"},{
          "@type":"ListItem",
          "name": "sending email feature",
          "description" : "let's see how to execute the email app installed basically on the phone at RN(React Native) project.",
          "position":34,"url": "https://deku.posstree.com/en/react-native/react-native-mail/",
          "item": "https://deku.posstree.com/en/react-native/react-native-mail/"},{
          "@type":"ListItem",
          "name": "Use Filesystem",
          "description" : "let's read and write the file by react-native-fs on RN(React Native) project.",
          "position":35,"url": "https://deku.posstree.com/en/react-native/react-native-fs/",
          "item": "https://deku.posstree.com/en/react-native/react-native-fs/"},{
          "@type":"ListItem",
          "name": "use After Effects",
          "description" : "let's see how to apply the animation created by Adobe After Effects, to RN(React Native) project.",
          "position":36,"url": "https://deku.posstree.com/en/react-native/react-native-lottie/",
          "item": "https://deku.posstree.com/en/react-native/react-native-lottie/"},{
          "@type":"ListItem",
          "name": "Swipe Detection",
          "description" : "let's see how to use react-native-swipe-gestures to detect user swipe event on RN(React Native) project",
          "position":37,"url": "https://deku.posstree.com/en/react-native/react-native-swipe-gestures/",
          "item": "https://deku.posstree.com/en/react-native/react-native-swipe-gestures/"},{
          "@type":"ListItem",
          "name": "Gradient",
          "description" : "let's see how to use react-native-linear-gradient to make the gradient background on RN(React Native) project.",
          "position":38,"url": "https://deku.posstree.com/en/react-native/react-native-linear-gradient/",
          "item": "https://deku.posstree.com/en/react-native/react-native-linear-gradient/"},{
          "@type":"ListItem",
          "name": "App Splash Screen",
          "description" : "let's make Splash screen end at the desired time by using react-native-splash-screen on RN(React Native) project.",
          "position":39,"url": "https://deku.posstree.com/en/react-native/react-native-splash-screen/",
          "item": "https://deku.posstree.com/en/react-native/react-native-splash-screen/"},{
          "@type":"ListItem",
          "name": "App Store Rating",
          "description" : "let's see how to induce users to give the rating by react-native-rate library on RN(React Native) project.",
          "position":40,"url": "https://deku.posstree.com/en/react-native/react-native-rate/",
          "item": "https://deku.posstree.com/en/react-native/react-native-rate/"},{
          "@type":"ListItem",
          "name": "iTunes file sharing feature",
          "description" : "let's see how to share files via iTunes on RN(React Native) project.",
          "position":41,"url": "https://deku.posstree.com/en/react-native/react-native-itunes-share-file/",
          "item": "https://deku.posstree.com/en/react-native/react-native-itunes-share-file/"},{
          "@type":"ListItem",
          "name": "Control StatusBar",
          "description" : "let's see how to control the StatusBar in RN(React Native)",
          "position":42,"url": "https://deku.posstree.com/en/react-native/react-native-status-bar/",
          "item": "https://deku.posstree.com/en/react-native/react-native-status-bar/"},{
          "@type":"ListItem",
          "name": "RN(React Native) Support Tablets",
          "description" : "let's see how to make RN(React Native) project support tablets",
          "position":43,"url": "https://deku.posstree.com/en/react-native/react-native-support-tablet/",
          "item": "https://deku.posstree.com/en/react-native/react-native-support-tablet/"},{
          "@type":"ListItem",
          "name": "How to use sqlite in RN(Reacct Native)",
          "description" : "let's see how to use sqlite database in RN(React Native).",
          "position":44,"url": "https://deku.posstree.com/en/react-native/react-native-sqlite-storage/",
          "item": "https://deku.posstree.com/en/react-native/react-native-sqlite-storage/"},{
          "@type":"ListItem",
          "name": "Apply custom font to RN(Reacct Native)",
          "description" : "let's see how to apply custom font to RN(React Native) and how to use custom font.",
          "position":45,"url": "https://deku.posstree.com/en/react-native/react-native-custom-font/",
          "item": "https://deku.posstree.com/en/react-native/react-native-custom-font/"},{
          "@type":"ListItem",
          "name": "Make Import path based on Root in RN(React Native)",
          "description" : "let's make Import path based on Root in RN(React Native)",
          "position":46,"url": "https://deku.posstree.com/en/react-native/root-import/",
          "item": "https://deku.posstree.com/en/react-native/root-import/"},{
          "@type":"ListItem",
          "name": "Open the app with the specific file",
          "description" : "this blog post is about how to open RN(React Native) app with the specific file(like excel, powerpoint, etc).",
          "position":47,"url": "https://deku.posstree.com/en/react-native/open-file-with-app/",
          "item": "https://deku.posstree.com/en/react-native/open-file-with-app/"},{
          "@type":"ListItem",
          "name": "Local Push Notificatoin",
          "description" : "let's see how to implement Local Push Notification by using react-native-push-notification.",
          "position":48,"url": "https://deku.posstree.com/en/react-native/react-native-push-notification/",
          "item": "https://deku.posstree.com/en/react-native/react-native-push-notification/"},{
          "@type":"ListItem",
          "name": "App icon & Splash image in React Native",
          "description" : "Let's see how to make App icon and Splash image via react-native-make library in React Native.",
          "position":49,"url": "https://deku.posstree.com/en/react-native/react-native-make/",
          "item": "https://deku.posstree.com/en/react-native/react-native-make/"},{
          "@type":"ListItem",
          "name": "Geolocation in React Native",
          "description" : "Let's see how to get user current geolocation to use react-native-geolocation-service library in React Native.",
          "position":50,"url": "https://deku.posstree.com/en/react-native/react-native-geolocation-service/",
          "item": "https://deku.posstree.com/en/react-native/react-native-geolocation-service/"},{
          "@type":"ListItem",
          "name": "Show Map on React Native",
          "description" : "Let's see how to use react-native-maps to display a map on React Native",
          "position":51,"url": "https://deku.posstree.com/en/react-native/react-native-maps/",
          "item": "https://deku.posstree.com/en/react-native/react-native-maps/"},{
          "@type":"ListItem",
          "name": "Deploy automatically applications via Fastlane",
          "description" : "Let's see how to deploy automatically React Native application via Fastlane",
          "position":52,"url": "https://deku.posstree.com/en/react-native/fastlane/",
          "item": "https://deku.posstree.com/en/react-native/fastlane/"},{
          "@type":"ListItem",
          "name": "react-native-image-modal",
          "description" : "let's see how to use react-native-image-modal to show full size image modal and pinch zoom in/out.",
          "position":53,"url": "https://deku.posstree.com/en/react-native/react-native-image-modal/",
          "item": "https://deku.posstree.com/en/react-native/react-native-image-modal/"},{
          "@type":"ListItem",
          "name": "react-native-image-picker",
          "description" : "Let's see how to take a photo and how to get the image from the Camera-roll via react-native-image-picker.",
          "position":54,"url": "https://deku.posstree.com/en/react-native/react-native-image-picker/",
          "item": "https://deku.posstree.com/en/react-native/react-native-image-picker/"},{
          "@type":"ListItem",
          "name": "Push message via react-native-firebase(V5)",
          "description" : "Let's see how to use FCM(Firebase Cloud Messaging) via react-native-firebase(V5) to implement Push message on React Native.",
          "position":55,"url": "https://deku.posstree.com/en/react-native/react-native-firebase-fcm/",
          "item": "https://deku.posstree.com/en/react-native/react-native-firebase-fcm/"},{
          "@type":"ListItem",
          "name": "Make Opensource for React Native",
          "description" : "Let's see how to make an opensource for React Native.",
          "position":56,"url": "https://deku.posstree.com/en/react-native/make-opensource-library/",
          "item": "https://deku.posstree.com/en/react-native/make-opensource-library/"},{
          "@type":"ListItem",
          "name": "Configure Multidex on React Native",
          "description" : "Let's see how to configure Multidex on Android in React Native project.",
          "position":57,"url": "https://deku.posstree.com/en/react-native/react-native-multidex/",
          "item": "https://deku.posstree.com/en/react-native/react-native-multidex/"},{
          "@type":"ListItem",
          "name": "react-native-firebase V6 installation",
          "description" : "To use Firebase on React Native, Let's see how to install react-native-firebase(V6).",
          "position":58,"url": "https://deku.posstree.com/en/react-native/react-native-firebase-v6-installation/",
          "item": "https://deku.posstree.com/en/react-native/react-native-firebase-v6-installation/"},{
          "@type":"ListItem",
          "name": "react-native-firebase V6 Crashlytics",
          "description" : "Let's see how to use react-native-firebase(V6) for Firebase Crashlytics.",
          "position":59,"url": "https://deku.posstree.com/en/react-native/react-native-firebase-v6-crashlytics/",
          "item": "https://deku.posstree.com/en/react-native/react-native-firebase-v6-crashlytics/"},{
          "@type":"ListItem",
          "name": "react-native-firebase V6 Admob",
          "description" : "Let's see how to use react-native-firebase(V6) for Firebase Admob.",
          "position":60,"url": "https://deku.posstree.com/en/react-native/react-native-firebase-v6-admob/",
          "item": "https://deku.posstree.com/en/react-native/react-native-firebase-v6-admob/"},{
          "@type":"ListItem",
          "name": "Play Youtube on React Native",
          "description" : "To play Youtube video on React Native, let's see how to use react-native-youtube!",
          "position":61,"url": "https://deku.posstree.com/en/react-native/react-native-youtube/",
          "item": "https://deku.posstree.com/en/react-native/react-native-youtube/"},{
          "@type":"ListItem",
          "name": "Admob Native Advanced on React Native",
          "description" : "Let's see how to use react-native-admob-native-ads to display Admob Native Advanced on React Native.",
          "position":62,"url": "https://deku.posstree.com/en/react-native/react-native-admob-native-ads/",
          "item": "https://deku.posstree.com/en/react-native/react-native-admob-native-ads/"},{
          "@type":"ListItem",
          "name": "In-App Purchases in React Native",
          "description" : "Let's see how to use react-native-iap to implement IAP(In-App Purchases) in React Native.",
          "position":63,"url": "https://deku.posstree.com/en/react-native/react-native-iap/",
          "item": "https://deku.posstree.com/en/react-native/react-native-iap/"},{
          "@type":"ListItem",
          "name": "GitHub Actions and Fastlane for deploying React Native App",
          "description" : "Let's see how to deploy React Native App with GitHub Actions and Fastlane.",
          "position":64,"url": "https://deku.posstree.com/en/react-native/github-actions-fastlane/",
          "item": "https://deku.posstree.com/en/react-native/github-actions-fastlane/"}]
    }
  </script><link rel="preload" as="style" href="/en/assets/highlight/railscasts.css"/><link rel="stylesheet" href="/en/assets/highlight/railscasts.css"/><script async src="/assets//vendor/lazysizes/lazysizes.min.js" async></script><link href="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" rel="preload" as="script"/><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav"><div class="container"><a class="navbar-brand" href="/en/"><img src="/assets/images/deku.svg" alt="[DeKu] DevYakuza blog logo"/><span class="name">DeKu</span></a><div class="navbar-menu-container"><div class="collapse navbar-collapse"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/en/">Home</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Category </a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/en/clog/">Clog</a><a class="dropdown-item" href="/en/ildangongbu/">일단공부(Il-Dan-Gong-Bu)</a><a class="dropdown-item" href="/en/vue/">Vue</a><a class="dropdown-item" href="/en/code_quality/">Code Quality</a><a class="dropdown-item" href="/en/git/">git</a><a class="dropdown-item" href="/en/books/">Writing Books</a><a class="dropdown-item" href="/en/environment/">dev environment</a><a class="dropdown-item" href="/en/share/">Share</a><a class="dropdown-item" href="/en/flutter/">Flutter</a><a class="dropdown-item" href="/en/tensorflow/">TensorFlow</a><a class="dropdown-item" href="/en/github_actions/">GitHub Actions</a><a class="dropdown-item" href="/en/golang/">Golang</a><a class="dropdown-item" href="/en/ruby/">Ruby</a><a class="dropdown-item" href="/en/jest/">Jest</a><a class="dropdown-item" href="/en/kumoncho/">kumoncho</a><a class="dropdown-item" href="/en/blaboo/">BlaBoo</a><a class="dropdown-item" href="/en/jekyll/">jekyll blog</a><a class="dropdown-item" href="/en/essay/">Essay</a><a class="dropdown-item" href="/en/react/">React</a><a class="dropdown-item" href="/en/web/">Knowledge about Web</a><a class="dropdown-item" href="/en/django/">django</a><a class="dropdown-item" href="/en/react-native/">React Native</a><a class="dropdown-item" href="/en/laravel/">Laravel</a><a class="dropdown-item" href="/en/kubernetes/">Kubernetes</a><a class="dropdown-item" href="/en/ruby-on-rails/">Ruby on Rails</a></div></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href=" /app/list/en/">Apps</a></li><li class="nav-item"><a class="nav-link" href="/en/contact/">Contact</a></li></ul></div><div class="btn-group-sm btn-translate-group dropdown"><button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="change language button"><i class="fa fa-language" aria-hidden="true"></i></button><div class="dropdown-menu"><a class="dropdown-item menu-ko" href="/ko/react-native/react-native-iap/">한국어</a><a class="dropdown-item menu-en" href="/en/react-native/react-native-iap/">English</a><a class="dropdown-item menu-ja" href="/en/react-native/react-native-iap/">日本語</a></div></div><button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"> Menu <i class="fa fa-bars"></i></button></div><div class="collapse navbar-collapse" id="navbarResponsive"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/en/">Home</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Category </a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/en/clog/">Clog</a><a class="dropdown-item" href="/en/ildangongbu/">일단공부(Il-Dan-Gong-Bu)</a><a class="dropdown-item" href="/en/vue/">Vue</a><a class="dropdown-item" href="/en/code_quality/">Code Quality</a><a class="dropdown-item" href="/en/git/">git</a><a class="dropdown-item" href="/en/books/">Writing Books</a><a class="dropdown-item" href="/en/environment/">dev environment</a><a class="dropdown-item" href="/en/share/">Share</a><a class="dropdown-item" href="/en/flutter/">Flutter</a><a class="dropdown-item" href="/en/tensorflow/">TensorFlow</a><a class="dropdown-item" href="/en/github_actions/">GitHub Actions</a><a class="dropdown-item" href="/en/golang/">Golang</a><a class="dropdown-item" href="/en/ruby/">Ruby</a><a class="dropdown-item" href="/en/jest/">Jest</a><a class="dropdown-item" href="/en/kumoncho/">kumoncho</a><a class="dropdown-item" href="/en/blaboo/">BlaBoo</a><a class="dropdown-item" href="/en/jekyll/">jekyll blog</a><a class="dropdown-item" href="/en/essay/">Essay</a><a class="dropdown-item" href="/en/react/">React</a><a class="dropdown-item" href="/en/web/">Knowledge about Web</a><a class="dropdown-item" href="/en/django/">django</a><a class="dropdown-item" href="/en/react-native/">React Native</a><a class="dropdown-item" href="/en/laravel/">Laravel</a><a class="dropdown-item" href="/en/kubernetes/">Kubernetes</a><a class="dropdown-item" href="/en/ruby-on-rails/">Ruby on Rails</a></div></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href=" /app/list/en/">Apps</a></li><li class="nav-item"><a class="nav-link" href="/en/contact/">Contact</a></li></ul></div></div></nav><script defer>document.addEventListener("DOMContentLoaded",function(){var e=window.location.pathname;e.indexOf("/en/")>=0?($(".menu-ko").prop("href",e.replace("/en/","/ko/")),$(".menu-en").prop("href",e),$(".menu-ja").prop("href",e.replace("/en/","/"))):e.indexOf("/ko/")>=0?($(".menu-ko").prop("href",e),$(".menu-en").prop("href",e.replace("/ko/","/en/")),$(".menu-ja").prop("href",e.replace("/ko/","/"))):($(".menu-ko").prop("href","/ko"+e),$(".menu-en").prop("href","/en"+e),$(".menu-ja").prop("href",e)),$("body").on("show.bs.dropdown",".dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideDown()}),$("body").on("hide.bs.dropdown",".dropdown",function(){$(this).find(".dropdown-menu").first().stop(!0,!0).slideUp()})});</script><header class="masthead" style="background-image: url('/assets/images/category/react-native/2020/react-native-iap/background.jpg')"><div class="overlay"></div><div class="container"><div class="row"><div class="col-lg-8 col-md-10 mx-auto"><div class="post-heading"><h1>In-App Purchases in React Native</h1><div class="heading-date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-10-17 <img style="width: inherit;" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2Fdev-yakuza.github.io%2F/react-native/react-native-iap/&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false" alt="hit count image"/></div><h2 class="subheading">Let's see how to use react-native-iap to implement IAP(In-App Purchases) in React Native.</h2><div class="sponsor_container"><a href="https://github.com/sponsors/dev-yakuza" target="_blank" rel="noopener" style=" background-color: #e6ebf1; background-image: linear-gradient(-180deg, #f0f3f6, #e6ebf1 90%); background-position: -0.5em; color: #24292e; text-decoration: none; border: 1px solid rgba(27, 31, 35, 0.35); padding: 6px 10px; user-select: none; background-repeat: repeat-x; background-position: -1px -1px; background-size: 110% 110%; border: 1px solid rgba(27, 31, 35, 0.2); border-radius: 0.25em; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -webkit-appearance: none; -moz-appearance: none; appearance: none; white-space: nowrap; vertical-align: middle; font-size: 17px; font-family: 'Lato', sans-serif !important; margin: 10px; display: inline-block; "><svg style="color: #ea4aaa; vertical-align: text-bottom !important;" viewBox="0 0 12 16" version="1.1" width="16" height="20" aria-hidden="true"><path fill-rule="evenodd" d="M8.727 3C7.091 3 6.001 4.65 6.001 4.65S4.909 3 3.273 3C1.636 3 0 4.1 0 6.3 0 9.6 6 14 6 14s6-4.4 6-7.7C12 4.1 10.364 3 8.727 3z"></path></svg> Github Sponsor </a><style> .bmc-button img { width: 27px !important; margin-bottom: 1px !important; border: none !important; vertical-align: middle !important; } .bmc-button { line-height: 36px !important; height: 37px !important; text-decoration: none !important; display: inline-block !important; color: #ffffff !important; background-color: #ff813f !important; border-radius: 3px !important; border: 1px solid transparent !important; padding: 0px 9px !important; font-size: 17px !important; letter-spacing: -0.08px !important; margin: 10px !important; font-family: 'Lato', sans-serif !important; -webkit-box-sizing: border-box !important; box-sizing: border-box !important; -o-transition: 0.3s all linear !important; -webkit-transition: 0.3s all linear !important; -moz-transition: 0.3s all linear !important; -ms-transition: 0.3s all linear !important; transition: 0.3s all linear !important; } .bmc-button:hover, .bmc-button:active, .bmc-button:focus { -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important; text-decoration: none !important; box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important; opacity: 0.85 !important; color: #ffffff !important; }</style><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext"/><link href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext" rel="stylesheet"/><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/j0cXhWiza" rel="noopener noreferrer nofollow"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"/><span style="margin-left:5px">Buy me a coffee</span></a></div></div></div></div></div></header><div class="ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="3850742490" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="1496496025" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-right"><ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="3797155229" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><div class="container container-contents"><div class="row"><div class="col-lg-8 col-md-10 mx-auto"><nav aria-label="breadcrumb"><ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList"><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemtype="http://schema.org/Thing" itemprop="item" href="/en/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"/></li><li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemtype="http://schema.org/Thing" itemprop="item" href="/en/react-native"><span itemprop="name">react-native</span></a><meta itemprop="position" content="2"/></li><li class="breadcrumb-item active" aria-current="page" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemtype="http://schema.org/Thing" itemprop="item" href="/en/react-native/react-native-iap/"><span itemprop="name">In-App Purchases in React Native</span></a><meta itemprop="position" content="3"/></li></ol></nav></div></div><div class="row"><div class="col-lg-2 col-md-1 d-none d-lg-block left-ads"><ins class="adsbygoogle sticky-top" style="display:block; padding-top: 80px; margin-bottom: 80px;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="1333703444" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><article class="col-lg-8 col-md-10 mx-auto"><div id="contents_list"><h2 id="contents">Contents</h2><ul><li><a href="#outline">Outline</a></li><li><a href="#create-iap-product">Create IAP product</a><ul><li><a href="#create-iap-product-on-ios">Create IAP product on iOS</a><ul><li><a href="#agreements-tax-and-banking">Agreements, Tax, and Banking</a></li><li><a href="#create-product-on-ios">Create product on iOS</a></li><li><a href="#insert-iap-metadata">Insert IAP metadata</a></li><li><a href="#configure-permission-on-ios">Configure permission on iOS</a></li></ul></li><li><a href="#create-iap-product-on-android">Create IAP product on Android</a><ul><li><a href="#configure-payments">Configure Payments</a></li><li><a href="#configure-permission-on-android">Configure permission on Android</a></li><li><a href="#create-product-on-android">Create product on Android</a></li></ul></li></ul></li><li><a href="#cording">Cording</a><ul><li><a href="#install-react-native-iap">Install react-native-iap</a></li><li><a href="#javascript">JavaScript</a><ul><li><a href="#initialization">Initialization</a></li><li><a href="#payment">Payment</a></li><li><a href="#validation">Validation</a></li><li><a href="#restore">Restore</a></li></ul></li></ul></li><li><a href="#test">Test</a><ul><li><a href="#ios">iOS</a><ul><li><a href="#create-test-account-on-ios">Create test account on iOS</a></li><li><a href="#test-on-ios">Test on iOS</a></li></ul></li><li><a href="#android">Android</a><ul><li><a href="#create-test-account-on-android">Create test account on Android</a></li><li><a href="#test-on-android">Test on Android</a></li></ul></li></ul></li><li><a href="#deployment">Deployment</a><ul><li><a href="#ios-deployment">iOS deployment</a></li><li><a href="#android-deployment">Android deployment</a></li></ul></li><li><a href="#completed">Completed</a></li></ul></div><h2 id="outline">Outline</h2><p>In this blog post, I will introduce how to use <code class="language-plaintext highlighter-rouge">react-native-iap</code> to implement IAP(In-App Purchases) on React Native.</p><ul><li><a href="https://github.com/dooboolab/react-native-iap" rel="nofollow noreferrer" target="_blank">react-native-iap</a></li></ul><h2 id="create-iap-product">Create IAP product</h2><p>We need to create a product for IAP(In-APp purchases). Let’s see how to make the product on each platform.</p><h3 id="create-iap-product-on-ios">Create IAP product on iOS</h3><h4 id="agreements-tax-and-banking">Agreements, Tax, and Banking</h4><p>To create IAP product on iOS, we need to configure <code class="language-plaintext highlighter-rouge">Agreements, Tax, and Banking</code> first. To set <code class="language-plaintext highlighter-rouge">Agreements, Tax, and Banking</code>, go to Appstore Connect.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/appstoreconnect.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/appstoreconnect.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/appstoreconnect.jpg" alt="Appstore connect"/></picture><p>Click the <code class="language-plaintext highlighter-rouge">Agreements, Tax, and Banking</code> on the bottom to move on.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/paid-apps.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/paid-apps.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/paid-apps.jpg" alt="Paid apps"/></picture><p>I already registered, so I can see the screen above, but you don’t have <code class="language-plaintext highlighter-rouge">Paid Apps</code> yet, so you need to set it. There are some items that you should insert. And just enter all necessary items, you can get <code class="language-plaintext highlighter-rouge">Paid Apps</code> on here.</p><h4 id="create-product-on-ios">Create product on iOS</h4><p>Next, we need to make a product for IAP on iOS. Click the app which you want to implement IAP.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/manage-in-app-purchases.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/manage-in-app-purchases.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/manage-in-app-purchases.jpg" alt="manage in-app purchases"/></picture><p>Click the <code class="language-plaintext highlighter-rouge">Manage</code> under <code class="language-plaintext highlighter-rouge">In-App Purchases</code> on the left bottom, and when you click the plus button(<code class="language-plaintext highlighter-rouge">+</code>), you can see the screen like above that you choose the product to add.</p><p>I added <code class="language-plaintext highlighter-rouge">Auto-Renewable Subscription</code> to my app, so I will explain to focus <code class="language-plaintext highlighter-rouge">Auto-Renewable Subscription</code>. When I add other products, I will modify this blog post about them.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-reference-name-product-id.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-reference-name-product-id.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-reference-name-product-id.jpg" alt="in-app purchases reference name and product id"/></picture><p>In here, <code class="language-plaintext highlighter-rouge">Reference Name</code> is shown up on only Appstore Connect, so choose the name that you can recognize easily. We will use <code class="language-plaintext highlighter-rouge">Product ID</code> to get the product information on the app.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-group-name.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-group-name.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-group-name.jpg" alt="in-app purchases group name"/></picture><p>Next, we need to insert <code class="language-plaintext highlighter-rouge">Subscription Group Reference Name</code>. it is also shown up on only Appstore Connect like <code class="language-plaintext highlighter-rouge">Reference Name</code>, so choose the name that you can find easily.</p><h4 id="insert-iap-metadata">Insert IAP metadata</h4><p>After creating IAP product item above, we need to add the metadata of the IAP item.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-metadata.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-metadata.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-metadata.jpg" alt="in-app purchases metadata"/></picture><p>when you click the <code class="language-plaintext highlighter-rouge">Manage</code> menu under <code class="language-plaintext highlighter-rouge">In-App Purchases</code> on the left bottom again, you can see the missing metadata. Click the reference name to go to the product item detail page.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-insert-metadata.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-insert-metadata.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-insert-metadata.jpg" alt="in-app purchases insert metadata"/></picture><p>On the detail page, you need to enter the metadata like below.</p><ul><li>Subscription Duration</li><li>Subscription Prices</li><li>Localizations of App Store Information</li><li>Review information</li></ul><p>In here, App store information(name and description) will be shown up on the app and Appstore, so be careful to write them. We can get the name and description via react-native-iap. If we don’t show them as they are, it can be rejected.</p><p>In order to avoid Reject, I have written the information in detail like how you can see the payment screen and what contents are shown up on the screen.</p><ul><li>Title of publication or service</li><li>Length of subscription (time period and/or content/services provided during each subscription period)</li><li>Price of subscription, and price per unit if appropriate</li><li>Payment will be charged to iTunes Account at confirmation of purchase</li><li>Subscription automatically renews unless auto-renew is turned off at least 24-hours before the end of the current period</li><li>Account will be charged for renewal within 24-hours prior to the end of the current period, and identify the cost of the renewal</li><li>Subscriptions may be managed by the user and auto-renewal may be turned off by going to the user’s Account Settings after purchase</li><li>Links to Your Privacy Policy and Terms of Use</li><li>Any unused portion of a free trial period, if offered, will be forfeited when the user purchases a subscription to that publication, where applicable</li></ul><p>If your app doesn’t have the contents above, you get the Reject. So, I’ve written the contents above with a screenshot.</p><h4 id="configure-permission-on-ios">Configure permission on iOS</h4><p>Next, we need to configure the permission on iOS for IAP feature.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/xcode-in-app-purchase.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/xcode-in-app-purchase.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/xcode-in-app-purchase.jpg" alt="in-app purchases insert metadata"/></picture><p>Open the project with Xcode, and add <code class="language-plaintext highlighter-rouge">In-App Purchase</code> on <code class="language-plaintext highlighter-rouge">Signing &amp; Capbilities</code>.</p><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h3 id="create-iap-product-on-android">Create IAP product on Android</h3><h4 id="configure-payments">Configure Payments</h4><p>You need to configure the <code class="language-plaintext highlighter-rouge">Payments</code> to get the payment when the users purchase. To set the <code class="language-plaintext highlighter-rouge">Payments</code>, go to Google Play Console and click <code class="language-plaintext highlighter-rouge">Settings</code> &gt; <code class="language-plaintext highlighter-rouge">Developer account</code> &gt; <code class="language-plaintext highlighter-rouge">Payments settings</code> to configure the <code class="language-plaintext highlighter-rouge">Payments</code> information.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-payments-settings.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-payments-settings.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/android-payments-settings.jpg" alt="Android Payments settings"/></picture><p>I used and connected <code class="language-plaintext highlighter-rouge">Google Adsense</code>, so I didn’t need to do anything.</p><h4 id="configure-permission-on-android">Configure permission on Android</h4><p>To create IAP product, when you go to Google Play Console and click the app that you want to make, and click <code class="language-plaintext highlighter-rouge">Subscriptions</code> menu, you can see the screen like below.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-subscription-menu.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-subscription-menu.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/android-subscription-menu.jpg" alt="android subscription"/></picture><p>On Android, you need to upload the app which has <code class="language-plaintext highlighter-rouge">BILLING</code> permission to create IAP product. First, open <code class="language-plaintext highlighter-rouge">android/app/src/main/AndroidManifest.xml</code> file and modify it to add <code class="language-plaintext highlighter-rouge">BILLING</code> permission like below.</p><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
  <span class="na">package=</span><span class="s">"io.github.dev.yakuza.toeicwords"</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"com.android.vending.BILLING"</span><span class="nt">/&gt;</span>
  ...
  <span class="nt">&lt;application</span>
      <span class="na">android:name=</span><span class="s">".MainApplication"</span>
</code></pre></div></div><p>After configuring the permission, upload the app to Google Play.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-after-uploading.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-after-uploading.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/android-after-uploading.jpg" alt="android subscription"/></picture><p>After uploading, you can see the contents changed on <code class="language-plaintext highlighter-rouge">Subscriptions</code> menu like above.</p><h4 id="create-product-on-android">Create product on Android</h4><p>Next, click <code class="language-plaintext highlighter-rouge">Create subscription</code> button on <code class="language-plaintext highlighter-rouge">Subscriptions</code> menu.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-after-uploading.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-after-uploading.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/android-after-uploading.jpg" alt="android subscription"/></picture><p>And then, enter the Subscription information to make a subscription item.</p><ul><li>Product ID</li><li>Subscription details(Name, Description)</li><li>Price(Billing period, Default price)</li></ul><p>The <code class="language-plaintext highlighter-rouge">Product ID</code> is for purchasing. Normally use the same <code class="language-plaintext highlighter-rouge">Product ID</code> with iOS in here. You can get the subscription detail, price, etc via react-native-iap by this ID. (I am not sure that the app is rejected, if we don’t display the subscription detail, price on Android like iOS.)</p><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h2 id="cording">Cording</h2><h3 id="install-react-native-iap">Install react-native-iap</h3><p>Execute the command below to install <code class="language-plaintext highlighter-rouge">react-native-iap</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>react-native-iap <span class="nt">--save</span>
</code></pre></div></div><p>And then execute the command below to install necessary libraries for iOS.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx pod-install
</code></pre></div></div><h3 id="javascript">JavaScript</h3><p>The code below is that I used for production apps.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">createContext</span><span class="p">,</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span><span class="p">,</span> <span class="nx">useCallback</span><span class="p">,</span> <span class="nx">useRef</span><span class="p">,</span> <span class="nx">useContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">AsyncStorage</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@react-native-async-storage/async-storage</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Alert</span><span class="p">,</span>
  <span class="nx">EmitterSubscription</span><span class="p">,</span>
  <span class="nx">Platform</span><span class="p">,</span>
  <span class="nx">Linking</span><span class="p">,</span>
  <span class="nx">ActivityIndicator</span><span class="p">,</span>
  <span class="nx">AppState</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-native</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Styled</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">styled-components/native</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Icon</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-native-vector-icons/MaterialCommunityIcons</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">SplashScreen</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-native-splash-screen</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">ENV</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">~/env</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ThemeContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">~/Context</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ActionSheet</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">~/Component</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">RNIap</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">InAppPurchase</span><span class="p">,</span>
  <span class="nx">SubscriptionPurchase</span><span class="p">,</span>
  <span class="nx">finishTransaction</span><span class="p">,</span>
  <span class="nx">purchaseErrorListener</span><span class="p">,</span>
  <span class="nx">purchaseUpdatedListener</span><span class="p">,</span>
  <span class="nx">Subscription</span><span class="p">,</span>
  <span class="nx">PurchaseError</span><span class="p">,</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-native-iap</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">checkReceipt</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./checkReceipt</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">purchaseUpdateSubscription</span><span class="p">:</span> <span class="nx">EmitterSubscription</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">purchaseErrorSubscription</span><span class="p">:</span> <span class="nx">EmitterSubscription</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">itemSubs</span> <span class="o">=</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">select</span><span class="p">({</span>
  <span class="na">default</span><span class="p">:</span> <span class="p">[</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">],</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">Container</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">View</span><span class="s2">`
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">TitleContainer</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">View</span><span class="s2">`
  justify-content: center;
  align-items: center;
  padding: 16px;
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">Title</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">Text</span><span class="s2">`
  font-size: 16px;
  font-weight: bold;
  color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.black};
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">SubTitle</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">Text</span><span class="s2">`
  font-size: 16px;
  color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.black};
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">DescriptionContainer</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">View</span><span class="s2">`
  padding: 0 24px;
  width: 100%;
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">Description</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">Text</span><span class="s2">`
  font-size: 14px;
  color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.black};
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">PurchaseButton</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">TouchableOpacity</span><span class="s2">`
  margin: 16px;
  padding: 16px;
  border-radius: 10px;
  background-color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.black};
  justify-content: center;
  align-items: center;
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">PurchaseLabel</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">Text</span><span class="s2">`
  color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.white};
  font-size: 16px;
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">Terms</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">Text</span><span class="s2">`
  font-size: 12px;
  color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.black};
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">Link</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">Text</span><span class="s2">`
  color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt; theme.primary};
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">LoadingContainer</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">View</span><span class="s2">`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  justify-content: center;
  align-items: center;
`</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">LoadingBackground</span> <span class="o">=</span> <span class="nx">Styled</span><span class="p">.</span><span class="nx">View</span><span class="s2">`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: </span><span class="p">${({</span> <span class="nx">theme</span> <span class="p">}:</span> <span class="p">{</span> <span class="nl">theme</span><span class="p">:</span> <span class="nx">Theme</span> <span class="p">}</span><span class="s2">): string =&gt;
    theme.isLightTheme ? theme.black : theme.white};
  opacity: 0.8;
`</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">Props</span> <span class="p">{</span>
  <span class="nl">children</span><span class="p">:</span> <span class="nx">JSX</span><span class="p">.</span><span class="nx">Element</span> <span class="o">|</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">JSX</span><span class="p">.</span><span class="nx">Element</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">IAPContext</span> <span class="o">=</span> <span class="nx">createContext</span><span class="o">&lt;</span><span class="nx">IAPContext</span><span class="o">&gt;</span><span class="p">({</span>
  <span class="na">isSubscription</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">subscription</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
  <span class="na">showPurchase</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{},</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">IAPProvider</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">children</span> <span class="p">}:</span> <span class="nx">Props</span><span class="p">):</span> <span class="nx">JSX</span><span class="p">.</span><span class="nx">Element</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">showLoading</span><span class="p">,</span> <span class="nx">setShowLoading</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">isSubscription</span><span class="p">,</span> <span class="nx">setIsSubscription</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">subscription</span><span class="p">,</span> <span class="nx">setSubscription</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">Subscription</span> <span class="o">|</span> <span class="kc">undefined</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">undefined</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">actionSheetRef</span> <span class="o">=</span> <span class="nx">useRef</span><span class="o">&lt;</span><span class="nx">ActionSheet</span><span class="o">&gt;</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">theme</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useContext</span><span class="o">&lt;</span><span class="nx">ThemeContext</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">ThemeContext</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">showPurchase</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">actionSheetRef</span><span class="p">.</span><span class="nx">current</span><span class="p">?.</span><span class="nx">open</span><span class="p">();</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">_checkReceipt</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">isValidated</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">checkReceipt</span><span class="p">();</span>

    <span class="nx">setIsSubscription</span><span class="p">(</span><span class="nx">isValidated</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">SplashScreen</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">_requestSubscription</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">subscription</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">RNIap</span><span class="p">.</span><span class="nx">requestSubscription</span><span class="p">(</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">productId</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">_restorePurchases</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">RNIap</span><span class="p">.</span><span class="nx">getAvailablePurchases</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">purchases</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">restorePurchases</span><span class="dl">'</span><span class="p">);</span>
        <span class="kd">let</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">transactionReceipt</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">android</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">purchaseToken</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">receipt</span> <span class="o">=</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">purchaseToken</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">);</span>
        <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
        <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span>
          <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">restore successful</span><span class="dl">'</span><span class="p">],</span>
          <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">you have successfully restored your purchase history</span><span class="dl">'</span><span class="p">],</span>
          <span class="p">[{</span> <span class="na">text</span><span class="p">:</span> <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">],</span> <span class="na">onPress</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">actionSheetRef</span><span class="p">.</span><span class="nx">current</span><span class="p">?.</span><span class="nx">close</span><span class="p">()</span> <span class="p">}],</span>
        <span class="p">);</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">restorePurchases</span><span class="dl">'</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
        <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
        <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">);</span>
        <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">restore failed</span><span class="dl">'</span><span class="p">],</span> <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">restore failed reason</span><span class="dl">'</span><span class="p">]);</span>
      <span class="p">});</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">_initIAP</span> <span class="o">=</span> <span class="nx">useCallback</span><span class="p">(</span><span class="k">async</span> <span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">RNIap</span><span class="p">.</span><span class="nx">clearProductsIOS</span><span class="p">();</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">initConnection</span><span class="p">();</span>
      <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">flushFailedPurchasesCachedAsPendingAndroid</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">"</span><span class="s2">couldn't get in-app-purchase information</span><span class="dl">"</span><span class="p">]);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">initConnection</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
      <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">fail to get in-app-purchase information</span><span class="dl">'</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="nx">purchaseUpdateSubscription</span> <span class="o">=</span> <span class="nx">purchaseUpdatedListener</span><span class="p">(</span>
      <span class="p">(</span><span class="na">purchase</span><span class="p">:</span> <span class="nx">InAppPurchase</span> <span class="o">|</span> <span class="nx">SubscriptionPurchase</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">purchaseUpdatedListener</span><span class="dl">'</span><span class="p">);</span>
        <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">actionSheetRef</span><span class="p">.</span><span class="nx">current</span><span class="p">?.</span><span class="nx">close</span><span class="p">();</span>
        <span class="p">},</span> <span class="mi">400</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span>
          <span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">ios</span><span class="dl">'</span> <span class="p">?</span> <span class="nx">purchase</span><span class="p">.</span><span class="nx">transactionReceipt</span> <span class="p">:</span> <span class="nx">purchase</span><span class="p">.</span><span class="nx">purchaseToken</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">receipt</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">finishTransaction</span><span class="p">(</span><span class="nx">purchase</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">);</span>
              <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
              <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span>
                <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">purchase is failed</span><span class="dl">'</span><span class="p">],</span>
                <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">the purchase is failed</span><span class="dl">'</span><span class="p">],</span>
              <span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">},</span>
    <span class="p">);</span>

    <span class="nx">purchaseErrorSubscription</span> <span class="o">=</span> <span class="nx">purchaseErrorListener</span><span class="p">((</span><span class="na">error</span><span class="p">:</span> <span class="nx">PurchaseError</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">purchaseErrorListener</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">E_USER_CANCELLED</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">purchase is failed</span><span class="dl">'</span><span class="p">],</span> <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">the purchase is failed</span><span class="dl">'</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="kd">const</span> <span class="nx">subscriptions</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">getSubscriptions</span><span class="p">(</span><span class="nx">itemSubs</span><span class="p">);</span>
    <span class="nx">setSubscription</span><span class="p">({</span>
      <span class="p">...</span><span class="nx">subscriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">});</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="kd">const</span> <span class="nx">handleAppStateChange</span> <span class="o">=</span> <span class="p">(</span><span class="na">nextAppState</span><span class="p">:</span> <span class="nx">string</span><span class="p">):</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">nextAppState</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">active</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_checkReceipt</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">_initIAP</span><span class="p">();</span>
    <span class="nx">_checkReceipt</span><span class="p">();</span>
    <span class="nx">AppState</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">change</span><span class="dl">'</span><span class="p">,</span> <span class="nx">handleAppStateChange</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">():</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">purchaseUpdateSubscription</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">purchaseUpdateSubscription</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">purchaseErrorSubscription</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">purchaseErrorSubscription</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">handleAppStateChange</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">AppState</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">change</span><span class="dl">'</span><span class="p">,</span> <span class="nx">handleAppStateChange</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">IAPContext</span><span class="p">.</span><span class="nx">Provider</span>
      <span class="nx">value</span><span class="o">=</span><span class="p">{{</span>
        <span class="nx">isSubscription</span><span class="p">,</span>
        <span class="nx">subscription</span><span class="p">,</span>
        <span class="nx">showPurchase</span><span class="p">,</span>
      <span class="p">}}</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">children</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="nx">ActionSheet</span>
        <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">actionSheetRef</span><span class="p">}</span>
        <span class="nx">height</span><span class="o">=</span><span class="p">{</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">ios</span><span class="dl">'</span> <span class="p">?</span> <span class="mi">380</span> <span class="p">:</span> <span class="mi">420</span><span class="p">}</span>
        <span class="nx">disableClose</span><span class="o">=</span><span class="p">{</span><span class="nx">showLoading</span><span class="p">}</span>
        <span class="nx">customStyles</span><span class="o">=</span><span class="p">{{</span>
          <span class="na">container</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">theme</span><span class="p">.</span><span class="nx">white</span><span class="p">,</span>
          <span class="p">},</span>
        <span class="p">}}</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">subscription</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">Container</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">TitleContainer</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Title</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> (</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]}</span><span class="o">&lt;</span><span class="sr">/Title</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">SubTitle</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/SubTitle</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/TitleContainer</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">DescriptionContainer</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Description</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Icon</span> <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">information-outline</span><span class="dl">"</span> <span class="o">/&gt;</span><span class="p">{</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">}</span>
                <span class="p">{</span>
                  <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span>
                    <span class="dl">"</span><span class="s2">I'm developing the app alone. So your subscription is a great help to me</span><span class="dl">"</span>
                  <span class="p">]</span>
                <span class="p">}</span>
              <span class="o">&lt;</span><span class="sr">/Description</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">Description</span><span class="o">&gt;</span>
                <span class="p">{</span><span class="dl">'</span><span class="s1">  </span><span class="dl">'</span><span class="p">}</span>
                <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">Your subscription helps me keep the good words app</span><span class="dl">'</span><span class="p">]}</span>
              <span class="o">&lt;</span><span class="sr">/Description</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">Description</span><span class="o">&gt;</span>
                <span class="p">{</span><span class="dl">'</span><span class="s1">  </span><span class="dl">'</span><span class="p">}</span>
                <span class="p">{</span>
                  <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span>
                    <span class="dl">'</span><span class="s1">Learn vocabulary without ads for the price of a cup of coffee each month</span><span class="dl">'</span>
                  <span class="p">]</span>
                <span class="p">}</span>
              <span class="o">&lt;</span><span class="sr">/Description</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/DescriptionContainer</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">PurchaseButton</span>
              <span class="nx">onPress</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">_requestSubscription</span><span class="p">();</span>
              <span class="p">}}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">PurchaseLabel</span><span class="o">&gt;</span>
                <span class="p">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">localizedPrice</span><span class="p">}</span> <span class="sr">/ {ENV.language</span><span class="se">[</span><span class="sr">'month'</span><span class="se">]</span><span class="err">}
</span>              <span class="o">&lt;</span><span class="sr">/PurchaseLabel</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/PurchaseButton</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">DescriptionContainer</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Terms</span><span class="o">&gt;</span>
                <span class="o">-</span> <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">Already subscribed?</span><span class="dl">'</span><span class="p">]}{</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">_restorePurchases</span><span class="p">()}</span><span class="o">&gt;</span>
                  <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">Restoring purchases</span><span class="dl">'</span><span class="p">]}</span>
                <span class="o">&lt;</span><span class="sr">/Link</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="sr">/Terms</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">Terms</span><span class="o">&gt;-</span> <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">cancel the purchase</span><span class="dl">'</span><span class="p">]}</span><span class="o">&lt;</span><span class="sr">/Terms</span><span class="err">&gt;
</span>              <span class="p">{</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">ios</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
                <span class="o">&lt;</span><span class="nx">Terms</span><span class="o">&gt;-</span> <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">payment is charged to your iTunes account</span><span class="dl">'</span><span class="p">]}</span><span class="o">&lt;</span><span class="sr">/Terms</span><span class="err">&gt;
</span>              <span class="p">)}</span>
              <span class="o">&lt;</span><span class="nx">Terms</span><span class="o">&gt;</span>
                <span class="o">-</span> <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">If you have any question,</span><span class="dl">'</span><span class="p">]}{</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">Linking</span><span class="p">.</span><span class="nx">openURL</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://deku.posstree.com/ko/contact/</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span>
                  <span class="nx">Contact</span>
                <span class="o">&lt;</span><span class="sr">/Link&gt;{' '</span><span class="err">}
</span>                <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">us</span><span class="dl">'</span><span class="p">]}</span>
              <span class="o">&lt;</span><span class="sr">/Terms</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">Terms</span><span class="o">&gt;</span>
                <span class="o">-</span> <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">see the</span><span class="dl">'</span><span class="p">]}</span>
                <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">Linking</span><span class="p">.</span><span class="nx">openURL</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://deku.posstree.com/privacy/ko/</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span>
                  <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">terms of use</span><span class="dl">'</span><span class="p">]}</span>
                <span class="o">&lt;</span><span class="sr">/Link&gt;{' '</span><span class="err">}
</span>                <span class="p">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">details</span><span class="dl">'</span><span class="p">]}</span>
              <span class="o">&lt;</span><span class="sr">/Terms</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/DescriptionContainer</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Container</span><span class="err">&gt;
</span>        <span class="p">)}</span>
        <span class="p">{</span><span class="nx">showLoading</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">LoadingContainer</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">LoadingBackground</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nx">ActivityIndicator</span> <span class="nx">color</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">.</span><span class="nx">primary</span><span class="p">}</span> <span class="nx">size</span><span class="o">=</span><span class="dl">"</span><span class="s2">large</span><span class="dl">"</span> <span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="sr">/LoadingContainer</span><span class="err">&gt;
</span>        <span class="p">)}</span>
      <span class="o">&lt;</span><span class="sr">/ActionSheet</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/IAPContext.Provider</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">IAPProvider</span><span class="p">,</span> <span class="nx">IAPContext</span> <span class="p">};</span>

</code></pre></div></div><p>The source code above is dependent on my project, so you can’t use it directly. Also, I use <code class="language-plaintext highlighter-rouge">Context API</code> to implement the payment logic. Let’s see the code one by one to understand the payment logic.</p><p>Mainly, We can divide the payment logic <code class="language-plaintext highlighter-rouge">initialization</code>, <code class="language-plaintext highlighter-rouge">payment</code>, <code class="language-plaintext highlighter-rouge">validation</code>, and <code class="language-plaintext highlighter-rouge">restore</code>.</p><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h4 id="initialization">Initialization</h4><p>First, we need to initialize the library, and get the product information.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="kd">const</span> <span class="nx">itemSubs</span> <span class="o">=</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">select</span><span class="p">({</span>
  <span class="na">default</span><span class="p">:</span> <span class="p">[</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">],</span>
<span class="p">});</span>
<span class="p">...</span>
<span class="kd">const</span> <span class="nx">IAPProvider</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">children</span> <span class="p">}:</span> <span class="nx">Props</span><span class="p">):</span> <span class="nx">JSX</span><span class="p">.</span><span class="nx">Element</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="kd">const</span> <span class="nx">_initIAP</span> <span class="o">=</span> <span class="nx">useCallback</span><span class="p">(</span><span class="k">async</span> <span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">RNIap</span><span class="p">.</span><span class="nx">clearProductsIOS</span><span class="p">();</span>

    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">initConnection</span><span class="p">();</span>
      <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">flushFailedPurchasesCachedAsPendingAndroid</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">"</span><span class="s2">couldn't get in-app-purchase information</span><span class="dl">"</span><span class="p">]);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">initConnection</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
      <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">fail to get in-app-purchase information</span><span class="dl">'</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="p">...</span>
    <span class="kd">const</span> <span class="nx">subscriptions</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">getSubscriptions</span><span class="p">(</span><span class="nx">itemSubs</span><span class="p">);</span>
    <span class="nx">setSubscription</span><span class="p">({</span>
      <span class="p">...</span><span class="nx">subscriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">});</span>
  <span class="p">},</span> <span class="p">[]);</span>
  <span class="p">...</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">_initIAP</span><span class="p">();</span>
    <span class="p">...</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">...</span>
  <span class="p">);</span>
<span class="p">};</span>
<span class="p">...</span>
</code></pre></div></div><p>To initialize the library, we can use the code below.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">RNIap</span><span class="p">.</span><span class="nx">clearProductsIOS</span><span class="p">();</span>

<span class="k">try</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">initConnection</span><span class="p">();</span>
  <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">flushFailedPurchasesCachedAsPendingAndroid</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">"</span><span class="s2">couldn't get in-app-purchase information</span><span class="dl">"</span><span class="p">]);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">initConnection</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
  <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">fail to get in-app-purchase information</span><span class="dl">'</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">clearProductsIOS</code> function and <code class="language-plaintext highlighter-rouge">flushFailedPurchasesCachedAsPendingAndroid</code> function are dependent the platform, but we don’t need to use <code class="language-plaintext highlighter-rouge">Platform.OS</code> to separate the logic in here.</p><p>And then, we need to set the product ID to get the subscription product information.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">itemSubs</span> <span class="o">=</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">select</span><span class="p">({</span>
  <span class="na">default</span><span class="p">:</span> <span class="p">[</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">],</span>
<span class="p">});</span>
</code></pre></div></div><p>I use the same ID between iOS and Android, so I just set the default, if the iOS ID and Android ID are different, you can set it like below.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">itemSubs</span> <span class="o">=</span> <span class="nx">Platform</span><span class="p">.</span><span class="nx">select</span><span class="p">({</span>
  <span class="na">ios</span><span class="p">:</span> <span class="p">[</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">ios</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">],</span>
  <span class="na">android</span><span class="p">:</span> <span class="p">[</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">android</span><span class="p">.</span><span class="nx">subscriptionId</span><span class="p">],</span>
<span class="p">});</span>
</code></pre></div></div><p>You can get the detail of the product by this product ID.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">subscriptions</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">getSubscriptions</span><span class="p">(</span><span class="nx">itemSubs</span><span class="p">);</span>
<span class="nx">setSubscription</span><span class="p">({</span>
  <span class="p">...</span><span class="nx">subscriptions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">});</span>
</code></pre></div></div><p>And store it on <code class="language-plaintext highlighter-rouge">State</code>. In my case, I have just one subscription item, so I just use <code class="language-plaintext highlighter-rouge">subscriptions[0]</code> to store one item.</p><p>And then, display the information on the screen like below.</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="o">&lt;</span><span class="nx">Title</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> (</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]}&lt;</span><span class="err">/</span><span class="na">Title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nc">SubTitle</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">description</span><span class="si">}</span><span class="p">&lt;/</span><span class="nc">SubTitle</span><span class="p">&gt;</span>
...
<span class="p">&lt;</span><span class="nc">PurchaseLabel</span><span class="p">&gt;</span>
  <span class="si">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">localizedPrice</span><span class="si">}</span> / <span class="si">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">month</span><span class="dl">'</span><span class="p">]</span><span class="si">}</span>
<span class="p">&lt;/</span><span class="nc">PurchaseLabel</span><span class="p">&gt;</span>
...
</code></pre></div></div><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h4 id="payment">Payment</h4><p>Next, let’s see the payment logic to use the product information stored above.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="kd">let</span> <span class="nx">purchaseUpdateSubscription</span><span class="p">:</span> <span class="nx">EmitterSubscription</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">purchaseErrorSubscription</span><span class="p">:</span> <span class="nx">EmitterSubscription</span><span class="p">;</span>
<span class="p">...</span>
<span class="kd">const</span> <span class="nx">IAPProvider</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">children</span> <span class="p">}:</span> <span class="nx">Props</span><span class="p">):</span> <span class="nx">JSX</span><span class="p">.</span><span class="nx">Element</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="kd">const</span> <span class="nx">_requestSubscription</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">subscription</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">RNIap</span><span class="p">.</span><span class="nx">requestSubscription</span><span class="p">(</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">productId</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="p">...</span>
  <span class="kd">const</span> <span class="nx">_initIAP</span> <span class="o">=</span> <span class="nx">useCallback</span><span class="p">(</span><span class="k">async</span> <span class="p">():</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">purchaseUpdateSubscription</span> <span class="o">=</span> <span class="nx">purchaseUpdatedListener</span><span class="p">(</span>
      <span class="p">(</span><span class="na">purchase</span><span class="p">:</span> <span class="nx">InAppPurchase</span> <span class="o">|</span> <span class="nx">SubscriptionPurchase</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
       <span class="p">...</span>
        <span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span>
          <span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">ios</span><span class="dl">'</span> <span class="p">?</span> <span class="nx">purchase</span><span class="p">.</span><span class="nx">transactionReceipt</span> <span class="p">:</span> <span class="nx">purchase</span><span class="p">.</span><span class="nx">purchaseToken</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">receipt</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">finishTransaction</span><span class="p">(</span><span class="nx">purchase</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">);</span>
              <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
              <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span>
                <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">purchase is failed</span><span class="dl">'</span><span class="p">],</span>
                <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">the purchase is failed</span><span class="dl">'</span><span class="p">],</span>
              <span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">},</span>
    <span class="p">);</span>

    <span class="nx">purchaseErrorSubscription</span> <span class="o">=</span> <span class="nx">purchaseErrorListener</span><span class="p">((</span><span class="na">error</span><span class="p">:</span> <span class="nx">PurchaseError</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">purchaseErrorListener</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">E_USER_CANCELLED</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">purchase is failed</span><span class="dl">'</span><span class="p">],</span> <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">the purchase is failed</span><span class="dl">'</span><span class="p">]);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="p">...</span>
  <span class="p">},</span> <span class="p">[]);</span>
  <span class="p">...</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="k">return</span> <span class="p">():</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">purchaseUpdateSubscription</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">purchaseUpdateSubscription</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">purchaseErrorSubscription</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">purchaseErrorSubscription</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="p">...</span>
    <span class="p">};</span>
  <span class="p">},</span> <span class="p">[]);</span>
  <span class="p">...</span>
<span class="p">};</span>
<span class="p">...</span>
</code></pre></div></div><p>We need to register the <code class="language-plaintext highlighter-rouge">Listener</code> to get the success or fail of the payment after purchasing.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="kd">let</span> <span class="nx">purchaseUpdateSubscription</span><span class="p">:</span> <span class="nx">EmitterSubscription</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">purchaseErrorSubscription</span><span class="p">:</span> <span class="nx">EmitterSubscription</span><span class="p">;</span>
<span class="p">...</span>
<span class="nx">purchaseUpdateSubscription</span> <span class="o">=</span> <span class="nx">purchaseUpdatedListener</span><span class="p">(</span>
  <span class="p">(</span><span class="nx">purchase</span><span class="p">:</span> <span class="nx">InAppPurchase</span> <span class="o">|</span> <span class="nx">SubscriptionPurchase</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span>
      <span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">ios</span><span class="dl">'</span> <span class="p">?</span> <span class="nx">purchase</span><span class="p">.</span><span class="nx">transactionReceipt</span> <span class="p">:</span> <span class="nx">purchase</span><span class="p">.</span><span class="nx">purchaseToken</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">receipt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">finishTransaction</span><span class="p">(</span><span class="nx">purchase</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">);</span>
          <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
          <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span>
            <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">purchase is failed</span><span class="dl">'</span><span class="p">],</span>
            <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">the purchase is failed</span><span class="dl">'</span><span class="p">],</span>
          <span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">},</span>
<span class="p">);</span>

<span class="nx">purchaseErrorSubscription</span> <span class="o">=</span> <span class="nx">purchaseErrorListener</span><span class="p">((</span><span class="nx">error</span><span class="p">:</span> <span class="nx">PurchaseError</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">});</span>
<span class="p">...</span>
<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="k">return</span> <span class="p">():</span> <span class="k">void</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">purchaseUpdateSubscription</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">purchaseUpdateSubscription</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">purchaseErrorSubscription</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">purchaseErrorSubscription</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="p">...</span>
  <span class="p">};</span>
<span class="p">},</span> <span class="p">[]);</span>
<span class="p">...</span>
</code></pre></div></div><p>If the payment is success, <code class="language-plaintext highlighter-rouge">purchaseUpdatedListener</code> is called, and use <code class="language-plaintext highlighter-rouge">finishTransaction</code> to notice the payment is finished. If the purchase is failed, <code class="language-plaintext highlighter-rouge">purchaseErrorListener</code> is called, and we need to notice the fail to the user.</p><p>Also, we need to unregister the Listener when the component is <code class="language-plaintext highlighter-rouge">Unmount</code> via <code class="language-plaintext highlighter-rouge">useEffect</code>.</p><p>Next, connect the <code class="language-plaintext highlighter-rouge">_requestSubscription</code> function and the payment button like below.</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="nc">PurchaseButton</span>
  <span class="na">onPress</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">_requestSubscription</span><span class="p">();</span>
  <span class="p">}</span><span class="si">}</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nc">PurchaseLabel</span><span class="p">&gt;</span>
    <span class="si">{</span><span class="nx">subscription</span><span class="p">.</span><span class="nx">localizedPrice</span><span class="si">}</span> / <span class="si">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">month</span><span class="dl">'</span><span class="p">]</span><span class="si">}</span>
  <span class="p">&lt;/</span><span class="nc">PurchaseLabel</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nc">PurchaseButton</span><span class="p">&gt;</span>
</code></pre></div></div><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h4 id="validation">Validation</h4><p>After purchasing, we can get the result of the payment. And then, we need to validate the result. we can validate the payment in the app or server on iOS, and we can validate the payment in the server on Android.</p><p>I didn’t have a server to validate, so I validated it in the app on iOS, and didn’t validate it on Android. On Android, I just validate the payment by getting the payment information again.</p><p>On iOS, you can use <code class="language-plaintext highlighter-rouge">validateReceiptIos</code> to validate in the App. Fist, get the Receipt by <code class="language-plaintext highlighter-rouge">getReceiptIOS</code> and then validate the Receipt via <code class="language-plaintext highlighter-rouge">validateReceiptIos</code> like below.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">checkReceiptIOS</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">isValidated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">receipt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newReceipt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getReceiptIOS</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">validated</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">validateReceiptIos</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="dl">'</span><span class="s1">receipt-data</span><span class="dl">'</span><span class="p">:</span> <span class="nx">newReceipt</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="dl">'</span><span class="s1">****************</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="nx">__DEV__</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">validated</span> <span class="o">!==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="nx">validated</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">isValidated</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">newReceipt</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">isValidated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">isValidated</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div><p>We need a <code class="language-plaintext highlighter-rouge">password</code> when we use <code class="language-plaintext highlighter-rouge">validateReceiptIos</code> to validate the receipt. This <code class="language-plaintext highlighter-rouge">password</code> is <code class="language-plaintext highlighter-rouge">Shared secret</code> on <code class="language-plaintext highlighter-rouge">Appstore connect</code>.</p><p>To make <code class="language-plaintext highlighter-rouge">Shared secret</code>, go to Appstore Connect and click <code class="language-plaintext highlighter-rouge">Users and Access</code>.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/ios-shared-secret.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/ios-shared-secret.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/ios-shared-secret.jpg" alt="ios shared secret"/></picture><p>On the top, click <code class="language-plaintext highlighter-rouge">Shared secret</code> and create a shared secret. You can use thee password issued in here for all your app. If you want to create a specific shared secret for an app, you can create it like below.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/ios-app-shared-secret.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/ios-app-shared-secret.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/ios-app-shared-secret.jpg" alt="ios app shared secret"/></picture><p>To create a specific shared secret, go to the app which you want to create the shared secret, and click <code class="language-plaintext highlighter-rouge">Manage</code> menu under <code class="language-plaintext highlighter-rouge">In-App Purchases</code>. On Manage, you can generate a shared secret via <code class="language-plaintext highlighter-rouge">App-Specific Shared Secret</code> on the right of the screen.</p><p>On Android, you can validate the receipt via <a href="https://github.com/dooboolab/react-native-iap#with-google-play" rel="nofollow noreferrer" target="_blank">validateReceiptAndroid</a>. But you need to make the <code class="language-plaintext highlighter-rouge">accessToken</code> via the server.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">checkReceiptAndroid</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">isValidated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">receipt</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">purchases</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">RNIap</span><span class="p">.</span><span class="nx">getAvailablePurchases</span><span class="p">();</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">checkReceiptAndroid</span><span class="dl">'</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">transactionReceipt</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">android</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">purchaseToken</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">receipt</span> <span class="o">=</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">purchaseToken</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">);</span>
      <span class="nx">isValidated</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">isValidated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">isValidated</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div><p>I don’t have the server, so I just get the product information via <code class="language-plaintext highlighter-rouge">getAvailablePurchases</code>, and if the information exists, I confirm the payment is OK.</p><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h4 id="restore">Restore</h4><p>If the user re-install the app, or disconnected to payment because of some reasons, we can restore via <code class="language-plaintext highlighter-rouge">getAvailablePurchases</code> function.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">_restorePurchases</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="nx">RNIap</span><span class="p">.</span><span class="nx">getAvailablePurchases</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">purchases</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">restorePurchases</span><span class="dl">'</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">receipt</span> <span class="o">=</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">transactionReceipt</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">OS</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">android</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">purchaseToken</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">receipt</span> <span class="o">=</span> <span class="nx">purchases</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">purchaseToken</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">,</span> <span class="nx">receipt</span><span class="p">);</span>
      <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span>
        <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">restore successful</span><span class="dl">'</span><span class="p">],</span>
        <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">you have successfully restored your purchase history</span><span class="dl">'</span><span class="p">],</span>
        <span class="p">[{</span> <span class="na">text</span><span class="p">:</span> <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">],</span> <span class="na">onPress</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">actionSheetRef</span><span class="p">.</span><span class="nx">current</span><span class="p">?.</span><span class="nx">close</span><span class="p">()</span> <span class="p">}],</span>
      <span class="p">);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="dl">'</span><span class="s1">restorePurchases</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="nx">setShowLoading</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="nx">setIsSubscription</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">receipt</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">Alert</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">restore failed</span><span class="dl">'</span><span class="p">],</span> <span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">restore failed reason</span><span class="dl">'</span><span class="p">]);</span>
    <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div><p>If you don’t implement the restore feature, you ill get the reject, so make sure to implement it!</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="nc">Link</span> <span class="na">onPress</span><span class="p">=</span><span class="si">{</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">_restorePurchases</span><span class="p">()</span><span class="si">}</span><span class="p">&gt;</span>
  <span class="si">{</span><span class="nx">ENV</span><span class="p">.</span><span class="nx">language</span><span class="p">[</span><span class="dl">'</span><span class="s1">Restoring purchases</span><span class="dl">'</span><span class="p">]</span><span class="si">}</span>
<span class="p">&lt;/</span><span class="nc">Link</span><span class="p">&gt;</span>
</code></pre></div></div><p>And the, connect the function to restore button like above.</p><h2 id="test">Test</h2><h3 id="ios">iOS</h3><h4 id="create-test-account-on-ios">Create test account on iOS</h4><p>To test on iOS, you need to <code class="language-plaintext highlighter-rouge">an email which you've never used for Apple account</code>. And then go to Appstore Connect, and click <code class="language-plaintext highlighter-rouge">Users and Access</code>.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/ios-sandbox-testers.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/ios-sandbox-testers.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/ios-sandbox-testers.jpg" alt="ios sandbox tester"/></picture><p>Click <code class="language-plaintext highlighter-rouge">Testers</code> under <code class="language-plaintext highlighter-rouge">Sandbox</code> on the left bottom, and insert the email to create a Sandbox account.</p><h4 id="test-on-ios">Test on iOS</h4><p>You can’t test on the simulator. You need to test IAP on the device.</p><p>First, logout your account on Appstore.</p><p>And then, open your app on the device, press the payment button. On payment process, login and purchase with the Sandbox account created above.</p><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h3 id="android">Android</h3><h4 id="create-test-account-on-android">Create test account on Android</h4><p>You can use the Google account that you used unlike iOS. Go to Google Play Console, and click <code class="language-plaintext highlighter-rouge">Settings</code> &gt; <code class="language-plaintext highlighter-rouge">License testing</code>.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-license-testing.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/android-license-testing.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/android-license-testing.jpg" alt="android license testing"/></picture><p>And then, enter your Google account here</p><h4 id="test-on-android">Test on Android</h4><p>You can’t test on the emulator like iOS. But you don’t logout unlike iOS.</p><p>You can test the subscription period and subscription end. See the details about this on the official document.</p><ul><li><a href="https://developer.android.com/google/play/billing/test#renewals" rel="nofollow noreferrer" target="_blank">Android in-app test period</a></li></ul><div class="in-feed-ads ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="2718813593"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block; text-align: center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-7987914246691031" data-ad-slot="6492035359"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><h2 id="deployment">Deployment</h2><h3 id="ios-deployment">iOS deployment</h3><p>When you deploy the app include IAP, you need to configure <code class="language-plaintext highlighter-rouge">In-App Purchases</code> section.</p><picture><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-deployment.avif" type="image/avif"/><source srcset="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-deployment.webp" type="image/webp"/><img src="/assets/images/category/react-native/2020/react-native-iap/in-app-purchases-deployment.jpg" alt="in-app purchases deployment"/></picture><h3 id="android-deployment">Android deployment</h3><p>You don’t need to do anything to deploy the app unlike iOS.</p><h2 id="completed">Completed</h2><p>We’ve seen how to use react-native-iap to implement IAP. I try to write all information in one blog post, so the post became too long.</p><p>And then, I like to write and share the blog post that I experience, so the blog post has only the subscription contents. If you want to implement the normal product, it’s a little bit different, so you need to implement the logic by referring to the contents above.</p><div class="sponsor_container"><a href="https://github.com/sponsors/dev-yakuza" target="_blank" rel="noopener" style=" background-color: #e6ebf1; background-image: linear-gradient(-180deg, #f0f3f6, #e6ebf1 90%); background-position: -0.5em; color: #24292e; text-decoration: none; border: 1px solid rgba(27, 31, 35, 0.35); padding: 6px 10px; user-select: none; background-repeat: repeat-x; background-position: -1px -1px; background-size: 110% 110%; border: 1px solid rgba(27, 31, 35, 0.2); border-radius: 0.25em; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -webkit-appearance: none; -moz-appearance: none; appearance: none; white-space: nowrap; vertical-align: middle; font-size: 17px; font-family: 'Lato', sans-serif !important; margin: 10px; display: inline-block; "><svg style="color: #ea4aaa; vertical-align: text-bottom !important;" viewBox="0 0 12 16" version="1.1" width="16" height="20" aria-hidden="true"><path fill-rule="evenodd" d="M8.727 3C7.091 3 6.001 4.65 6.001 4.65S4.909 3 3.273 3C1.636 3 0 4.1 0 6.3 0 9.6 6 14 6 14s6-4.4 6-7.7C12 4.1 10.364 3 8.727 3z"></path></svg> Github Sponsor </a><style> .bmc-button img { width: 27px !important; margin-bottom: 1px !important; border: none !important; vertical-align: middle !important; } .bmc-button { line-height: 36px !important; height: 37px !important; text-decoration: none !important; display: inline-block !important; color: #ffffff !important; background-color: #ff813f !important; border-radius: 3px !important; border: 1px solid transparent !important; padding: 0px 9px !important; font-size: 17px !important; letter-spacing: -0.08px !important; margin: 10px !important; font-family: 'Lato', sans-serif !important; -webkit-box-sizing: border-box !important; box-sizing: border-box !important; -o-transition: 0.3s all linear !important; -webkit-transition: 0.3s all linear !important; -moz-transition: 0.3s all linear !important; -ms-transition: 0.3s all linear !important; transition: 0.3s all linear !important; } .bmc-button:hover, .bmc-button:active, .bmc-button:focus { -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important; text-decoration: none !important; box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important; opacity: 0.85 !important; color: #ffffff !important; }</style><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext"/><link href="https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext" rel="stylesheet"/><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/j0cXhWiza" rel="noopener noreferrer nofollow"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"/><span style="margin-left:5px">Buy me a coffee</span></a></div><p><code class="language-plaintext highlighter-rouge"> Was my blog helpful? Please leave a comment at the bottom. it will be a great help to me! </code></p><h2>App promotion</h2><div class="book-greeting"> You can use the applications that are created by this blog writer <code class="highlighter-rouge">Deku</code>.<br/><code class="highlighter-rouge">Deku</code> created the applications with Flutter.<br/><br/> If you have interested, please try to download them for free.<br/><br/><div class="row" style="display: flex;"><div class="col-lg-4 col-md-4 col-sm-auto col-auto" style="margin-bottom: 40px; display: flex; align-items: center;"><a class="app_container" href="/en/app/blaboo/en/" target="_blank"><img class="app_logo_image" src="/assets/images/logo/blaboo.png" alt="word learning app for kids, BlaBoo"/><div><div class="app_description">word learning app for kids</div><div class="app_title">BlaBoo</div></div></a></div><div class="col-lg-4 col-md-4 col-sm-auto col-auto" style="margin-bottom: 40px; display: flex; align-items: center;"><a class="app_container" href="/en/app/koreanwords/" target="_blank"><img class="app_logo_image" src="/assets/images/logo/koreanwords.png" alt="Korean vocabulary, TOPIK words"/><div><div class="app_description">Korean TOPIK vocabulary app</div><div class="app_title">TOPIK words</div></div></a></div><div class="col-lg-4 col-md-4 col-sm-auto col-auto" style="margin-bottom: 40px; display: flex; align-items: center;"><a class="app_container" href="/en/app/japanesewords/" target="_blank"><img class="app_logo_image" src="/assets/images/logo/japanesewords.png" alt="Japanese vocabulary app"/><div><div class="app_description">Japanese vocabulary app</div><div class="app_title">Japanese words</div></div></a></div></div><div class="row" style="display: flex;"><div class="col-lg-4 col-md-4 col-sm-auto col-auto" style="margin-bottom: 40px; display: flex; align-items: center;"><a class="app_container" href="/en/app/chinesewords/" target="_blank"><img class="app_logo_image" src="/assets/images/logo/hskwordsen.png" alt="Chinese HSK vocabulary app"/><div><div class="app_description">Chinese HSK vocabulary app</div><div class="app_title">HSK words</div></div></a></div></div></div></article><div class="col-lg-2 col-md-1 d-none d-lg-block right-ads"><ins class="adsbygoogle sticky-top" style="display:block; padding-top: 80px; margin-bottom: 80px;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="9858937018" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><div class="ads-container"><div class="ads-block ads-left"><ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="1936214968" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-center"><ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="1507571483" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="ads-block ads-right"><ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7987914246691031" data-ad-slot="9369594845" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div><div class="row"><div class="col-lg-8 col-md-10 mx-auto"><div class="post-list-container"><div class="header"><div class="header-title">Posts</div><div id="search-bar"><label for="search" style="width: 0; height: 0; overflow: hidden; float: left;">Search</label><i class="fa fa-search" aria-hidden="true"></i><input id="search" type="text" placeholder="Search..."/></div></div><div class="body"><div class="list-group"></div></div><div class="footer"><ul class="pagination"><li class="page-item page-item--previous"><div class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span><span class="sr-only">Previous</span></div></li><li class="page-item page-item--next"><div class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span><span class="sr-only">Next</span></div></li></ul></div></div><script defer type="text/javascript">document.addEventListener("DOMContentLoaded",function(){function e(e,a){$(".page").remove(),$(".page-item--link").remove();var t=$(".post-list-container .body .list-group");e.forEach(function(e,i){var s=Math.floor(i/8)+1,n=t.find(".page-"+s),o=!1===a&&e.url.indexOf(location.pathname)>=0?"active":"",l="";if(l+='<a href="'+e.url+'" class="list-group-item list-group-item-action flex-column align-items-start '+o+'">',l+='  <div class="d-flex w-100 justify-content-between">',l+='    <div class="mb-1">'+e.title+"</div>",l+="  </div>",l+='  <div class="body-text">'+e.description+"</div>",l+="</a>",n.length>0)n.addClass(!0===a&&1===s?"active":o),n.append(l);else{var p="";p+='<div class="page page-'+s+" "+(!0===a&&1===s?"active":o)+'">',p+=l,p+="</div>",t.append(p)}var d="";d+='<li class="page-item page-item--link '+o+'" data-page="'+s+'">',d+='  <div class="page-link" data-page="'+s+'">',d+=s,d+="  </div>",d+="</li>",0===$('.post-list-container .footer .page-item[data-page="'+s+'"]').length&&$(".post-list-container .footer .page-item--next").before(d),!0===a?$("li[data-page=1]").addClass("active"):"active"===o&&$("li[data-page="+s+"]").addClass(o),s>1&&$(".footer").css("display","flex")})}var a=[];$.get("/en/api/react-native/posts.json",function(t){a=t,t.length>0&&($(".post-list-container").show(),e(t,!1))}),$("body").on("click",".page-link",function(){var e=$(".post-list-container .body .list-group"),a=$(".footer .pagination"),t=a.find(".page-item.active"),i=t.find(".page-link").data("page"),s=$(this).data("page");if($(this).closest(".page-item").hasClass("page-item--previous"))s=i>1?i-1:1;else if($(this).closest(".page-item").hasClass("page-item--next")){var n=a.find(".page-item--link").length;s=i<n?i+1:n}else var s=$(this).data("page");e.find(".page").removeClass("active"),e.find(".page-"+s).addClass("active"),a.find(".page-item").removeClass("active"),a.find('.page-link[data-page="'+s+'"]').closest(".page-item").addClass("active")}),$("#search").on("keyup",function(){var t=this.value.toLowerCase(),i=[];if($(".footer .pagination"),t.length>0){for(var s=0;s<a.length;s++){var n=a[s];(n.title.toLowerCase().indexOf(t)>=0||n.description.toLowerCase().indexOf(t)>=0)&&i.push(n)}e(i,!0)}else e(a,!1)})});</script></div><div class="col-lg-8 col-md-10 mx-auto"><hr/><script src="https://utteranc.es/client.js" repo="dev-yakuza/dev-yakuza.github.io" issue-term="title" label="comment" theme="github-light" crossorigin="anonymous" async></script></div></div></div></div><footer><div class="container"><div class="row"><div class="col-lg-8 col-md-10 mx-auto share-title"> SHARE </div><div class="col-lg-8 col-md-10 mx-auto"><ul class="list-inline text-center"><li class="list-inline-item"><a href="https://twitter.com/intent/tweet?text=In-App Purchases in React Native&url=https://deku.posstree.com/react-native/react-native-iap/" rel="nofollow noreferrer noopener" target="_blank"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span><div style="width: 0; height: 0; overflow: hidden; float: left;"> Twitter </div></a></li><li class="list-inline-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://deku.posstree.com/react-native/react-native-iap/" rel="nofollow noreferrer noopener" target="_blank"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-facebook fa-stack-1x fa-inverse"></i></span><div style="width: 0; height: 0; overflow: hidden; float: left;"> Facebook </div></a></li><li class="list-inline-item"><a href="https://deku.posstree.com/en/feed.xml" rel="nofollow noreferrer noopener" target="_blank"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-rss-square fa-stack-1x fa-inverse" aria-hidden="true"></i></span><div style="width: 0; height: 0; overflow: hidden; float: left;"> RSS </div></a></li></ul><p class="copyright text-muted"> Copyright &copy; dev.yakuza@gmail.com 2024 </p></div></div></div></footer><script src="/assets/vendor/jquery/jquery.min.js"></script><script async src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script async src="/assets/vendor/startbootstrap-clean-blog/js/clean-blog.min.js"></script><script async src="/assets/scripts.js?v=20241127"></script><link rel="preload" as="style" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/railscasts.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/railscasts.min.css"><script defer src="/assets/highlight/highlight.pack.js"></script><script defer>document.addEventListener("DOMContentLoaded",function(){hljs.initHighlightingOnLoad()});</script></body></html>